metadata:
    language: v2-beta
    name: "Extended Out-of-Band SSRF Injections"
    description: "Inserts a Collaborator address into each parameter to detect SSRF with different schemes and paths through HTTP or DNS interactions."
    author: "alp1n3.eth"
    tags: "active", "injection", "ssrf", "server-side request forgery", "scan", "collaborator"

run for each:
    ssrfaddress= `{generate_collaborator_address()}/xyz`, `http://{generate_collaborator_address()}/xyz`, `https://{generate_collaborator_address()}/xyz`, `www.{generate_collaborator_address()}/xyz`


given insertion point then
    send payload:
        replacing: {ssrfaddress}

    if http interactions then
        report issue and continue:
            severity: high
            confidence: firm
            detail: "HTTP OOB SSRF Discovery by BCheck: Explore the Request Tab to Observe the Payload and Attempt to Self-Capture."
            remediation: "Implement SSRF remediation measures to mitigate the vulnerability."
    end if


    if dns interactions  then
        report issue:
            severity: medium
            confidence: tentative
            detail: "DNS OOB SSRF Discovery by BCheck: Explore the Request Tab to Observe the Payload and Attempt to Self-Capture. Ensure the interaction is from the target URL and not a CDN/proxy/etc."
            remediation: "Implement SSRF remediation measures to mitigate the vulnerability."
    end if
