metadata:
    language: v2-beta
    name: "CVE-2025-29927 Next.js Middleware Bypass"
    description: "Next.js Detected, possible vulnerability"
    author: "Paul Schmelzel"
    tags: "CVE-2025-29927","Next.js","Nextjs","Bypass"

given request then
    send request:
        headers:
            "x-nextjs-data": "1"

    if {latest.response.headers} matches "x-nextjs-rewrite:" then
        report issue:
            severity: medium
            confidence: firm
            detail: "The site is using NextJS and may be vulnerble to a bypass as described in CVE-2025-29927. See https://slcyber.io/assetnote-security-research-center/doing-the-due-diligence-analysing-the-next-js-middleware-bypass-cve-2025-29927/ for further exploit details."
            remediation: "Do not accept headers from users such as x-nextjs-data or x-middleware-subrequest."
    end if
